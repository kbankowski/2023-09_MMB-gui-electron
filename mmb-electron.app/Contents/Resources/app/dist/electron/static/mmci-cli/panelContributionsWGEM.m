function panelContributionsWGEM(project_path, contributionSeries, ProjectName, ProductName, chartName)

% Please specify the list of the variables to plot   
VarListToPlot = string(reshape(fieldnames(contributionSeries.total), 1, []));

% Please specify the date range of the series
DateRange = qq(2822,2):qq(2822,2)+15;
aShift = DateRange(1) - qq(1);
DateRangeNorm = DateRange - aShift;
DateRangeDateTime = dater.toMatlab(DateRangeNorm);

% Plotting
figure

% Defining the shape of the figure
tiledlayout_width = 1; %Specify the # of columns desired
tiledlayout_height = ceil(length(VarListToPlot)/tiledlayout_width);

t = tiledlayout(tiledlayout_height, tiledlayout_width, 'TileSpacing', 'compact','Padding','compact');

h = gcf;
FigureHeight = min(29.7, tiledlayout_height*6.5);
set(h, 'Units','centimeters', 'Position',[0 0 21-2*2.5 FigureHeight])
set(h,'defaulttextinterpreter','latex');

for aItem = VarListToPlot %for each panel
    nexttile;
    grid on
    hold on 

    % Seeting of the title
    aTitle = sprintf('Decomposition of %s', contributionSeries.lhs.(aItem));        
    title( ...
        aTitle ...
        , 'Fontsize', 7 ...
        , 'Fontweight', 'normal' ...
    );

    % actual data
    try
        bars_ = barcon( ...
            DateRangeNorm ...
            , redate(contributionSeries.contrib.(aItem), DateRange(1), DateRangeNorm(1)) ...
            , "ColorMap", cell2mat(contributionSeries.colorTable{contributionSeries.contrib.(aItem).Comment, :}) ...
            , 'EdgeColor', 'none');
    catch
    end  
    % targets
    try
        line_ = plot( ...
            DateRangeNorm ...
            , redate(contributionSeries.total.(aItem), DateRange(1), DateRangeNorm(1)) ...
            , 'color', cell2mat(contributionSeries.colorTable{aItem, :}) ...
            , 'linewidth', 2 ...
            , 'Marker', '_' ...
            , 'MarkerFaceColor', plotting.rgb('black') ...
            , 'MarkerEdgeColor', plotting.rgb('black') ...
            , 'MarkerSize', 4 ...
            );
    catch
    end
    
    hold off

    % Setting of the x and y axis
    xtickformat(gca,'yyQQQ')

    set(gca ...
        , 'Xtick', DateRangeDateTime(1:4:end) ...
        , 'Fontsize', 7 ...
        , 'Box', 'off' ...
        , 'TickLabelInterpreter','latex' ...
    );

    legendLabels = replace([contributionSeries.contrib.(aItem).Comment, aItem], "_", "\_");
    legend( ...
        [bars_, line_] ...
        , legendLabels ...
        , 'location', 'northoutside' ...
        , 'Interpreter','latex' ...
        , 'Fontsize', 6 ...
        , 'NumColumns', 2 ...
        );


end 
    
% Save graph
fileName = sprintf('%s/docu/%s/%s/figures/panelContrib_%s', project_path, ProjectName, ProductName, chartName);
exportgraphics(t, sprintf('%s.png',fileName),'BackgroundColor','none');
end